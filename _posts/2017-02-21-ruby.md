---
layout: post
title: ruby
---
#### 安裝rvm
1. `gpg --keyserver hkp://keys.gnupg.net --recv-keys 409B6B1796C275462A1703113804BB82D39DC0E3`	  
2. `\curl -sSL https://get.rvm.io | bash -s stable`
3. `source ~/.rvm/scripts/rvm`

<!--more-->

#### 安裝ruby  
1. `rvm install ruby-2.4.0`    
2. `/bin/bash --login`    
3. `gem i awesome_print (code highlight)`    
<hr>  
#### 測試
1. `ruby -v`  查看版本 
2. 用irb進入測試模式(console mode)    

#### 印出文字
```ruby
print  #不換行  
puts   #換行  
```
所有東西在ruby都是物件  
所有物件都有`.class`這個method可以看物件種類  
```ruby
(123).class   #Integer
(123).methods #列出class所有可用方法
```
#### 變數
`var`  local variable  
`@var` instance varible  
`$var` global varible  

#### 字串
```ruby
"helloWorld".length       #10
"reverseMethod".reverse   #"dohteMesrever"  

#字串串接
x = 999  
puts "hello#{x}world"     #hello999world
```
#### 註解
```ruby
# I'm comment

=begin
I'm comment one.
I'm comment two.
=end
```

#### 讀取字串
```ruby
print "What's your name?"
user_input = gets.chomp
user_input.downcase!

#chomp : remove extra line
# .downcase! :轉換成小寫
# !(modified in-place),否則會create一個copy
```

#### 流程控制  
```ruby
if x > y
  puts "x > y" 
elsif x < y
  puts "x < y"
else
  puts "x = y"
end
```
```ruby
hungry = false
unless hungry
  puts "I'm writing Ruby programs!"
else
  puts "Time to eat!"
end

#I'm writing Ruby programs!
#nil
```
```ruby
x = 3  
case x  
  when 1  
    puts 1  
  when 2  
    puts 2  
  when 3  
    puts 3  
  end  
#3  
```
#### 迴圈
```ruby
for num in 1...10
  puts num
end

# ... 1~9
# ..  1~10
```
```ruby
i = 20
loop do
  i -= 1
  next if i % 2 == 1 #遇到奇數略過
  print "#{i}"
  break if i <= 0
end

#181614121086420nil
```
```ruby
odds = [1,3,5,7,9]
odds.each do |i|
    print i
end
```

```ruby
x = 0  
while true  
  x += 1  
  puts x  
  break if x > 10  
end  
```
```ruby
10.times do |x|
    print "helloworld"
end
```
#### hash
```ruby
animal = {
  "dog" => "hot dog",
  "cat" => "fat cat",
  "fox" => "fox HD",
  "duck" => "Donald Duck"
}
  
animal.each do |key, value|
    puts "#{key}: #{value}"
end

=> (hash rocket)
```
```ruby
num = {:one => 1, :two => 2}
# 等價於
num = {one: 1, two: 2}
```
```ruby
hash.select{|k, v| v > 3}
hash.each_key{|k| puts k}
hash.each_value{|v| puts v}
```
##### string & symbol
```ruby
puts "string".object_id #17228620
puts "string".object_id #17228380

puts :symbol.object_id  #319528
puts :symbol.object_id  #319528

#hash的key不適合用String 因為String會new新的物件而Symbol不會  
#效能上symbol會比string好

# .to_s             轉成string
# .to_sym (.intern) 轉成symbol
```

#### 定義methods
```ruby
def greeting
  puts "hello"
end
```
```ruby
def pow(x)
  puts x ** 2
end
```
```ruby
arr = [3,4,6,1,4,2,4,5,7,10]
arr.sort!
```
```ruby
5.upto(10){ |num| print num } # 5678910
10.downto(1){ |num| print num }
```
```ruby
num = [1,2,3]
num.collect! { |num| num ** 2 }
#[1,4,9]
```
```ruby
#yield
def double(num)
  puts "line1"
  yield(num)
  puts "line2"
end

double(2) { |n| puts 2*n }
# line1
# 4
# line2
```
#### block
```ruby 
double = Proc.new{ |num| num * 2}
[1,2,3].map!(&double)
# [2,4,6]
# & convert double Proc into block
```
```ruby
multiples_of_3 = Proc.new do |n|
  n % 3 == 0
end

(1..100).to_a.select(&multiples_of_3)
#select all num n % 3 == 0
```
```ruby   
hi = Proc.new { puts "Hello!" }
hi.call
# Hello!
```
```ruby   
def temp4 (x ,y = 1, *argv, &block)  # *argv多餘的值,block方法  
  block.call(x, y, argv)  
end   
temp4 1,2,3 do |x,y,argv|  
  ap [x,y,argv]  
end  
```
```ruby
def temp5(&block)  
  puts block.class  
  block.call(99)    
end  
temp5{|x| puts x}  
```
#### 運算子
```ruby
<=>   #比較運算  
**    #次方
||=   #如果沒有定義就初始化成後面敘述
```
```ruby
<<    #push
arr = [1,2,3]
arr << 4    # [1,2,3,4]
```
#### Class
```ruby
class Car    
  def set_color(color)  
    @color = color		#@color instance varible  
  end  
  def get_color  
    @color  
  end  
end  

blue_car = Car.new   
red_car  = Car.new  
blue_car.set_color('BLUE')  
red_car.set_color('RED')  
blue_car.get_color  #BLUE   
red_car.get_color   #RED   
```
```text
$  global variable
@  instance variable
@@ class variable
```
#### 繼承
```ruby
class Animal
  def say
    puts "I'm Animal."
  end
end

class Cat < Animal # < Inheritance Syntax
  def say
    super  
    puts "I'm Cat."
  end
end

# I'am Amimal.
# I'am Cat. 
```
#### module
> a set of methods.

module不能被new
```ruby
module Greeting 
  def hi
    puts "hi" 
  end
  def hello
    puts "hello"
  end
end

class People
  extend Greeting
end

People.hi  # hi
``` 
`::` scope resolution operator
```ruby
puts Math::PI #在Math module下的PI
```
#### Mixin
> 在class中可以用include來載入module
  
#### Call System
\`pwd\` 或 `system('pwd')`    

#### 教學網站
* [codecademy Ruby](https://www.codecademy.com/learn/ruby)  
* [RailsFun.tw 新手教學 day1 HD](https://www.youtube.com/watch?v=6XUnYRB0Zpo)
